<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Guarded (hardcaml.HardCaml__Signal.Guarded)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0"/></head><body><nav><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">hardcaml</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">HardCaml__Signal.Guarded</span></h1></header><div class="doc"><p>Guarded assignments.</p><p>Allows code to be written in a similar manner to verilog always or vhdl
process blocks. 'if' and 'switch' control constructs are provided. ($==)
is used for assignment.</p><p>Code is written as lists of assignments, if and control statements.</p><p>variables;</p><pre><code class="code">
    let var = g_wire (zero 8) in
    let var = g_reg r_sync enable 8 in
</code></pre><p>assignment;</p><pre><code class="code">
    var $== exp;
</code></pre><p>if statements;</p><pre><code class="code">
    g_if condition [ ... ] [ ... ]
</code></pre><p>switch statements;</p><pre><code class="code">
    g_switch condition [
    consti 3 0 [ ... ]
    consti 3 1 [ ... ]
    consti 3 2 [ ... ]
    consti 3 3 [ ... ]
    ]
</code></pre><p>signals;</p><pre><code class="code">
    let (s:signal) = q (v:guarded) in
</code></pre><p>compilation;</p><pre><code class="code">
    compile [ ... ]
</code></pre><p>example;</p><pre><code class="code">
    let state = g_reg r_sync enable 2 in
    let a = g_wire 8 in
    compile [
        g_if (q a) ==: consti 8 4 [
            a $== consti 8 2
        ]
        g_switch (q state) [
            (consti 2 0) [
                a $== 3;
                state $== const 2 1;
            ]
            (consti 2 1) [
                a $== 2;
                state $== const 2 2;
            ]
            (consti 2 2) [
                a $== 1;
                state $== const 2 3;
            ]
            (consti 2 3) [
                a $== 0;
                state $== const 2 4;
            ]
        ]
    ]
    let state = q state in
    let a = q a in
    ....
</code></pre></div><div class="spec type" id="type-statement"><a href="#type-statement" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>statement</code><code></code><code></code></div><div class="doc"><p>the type of statements in guarded assigments</p></div></div><div class="spec type" id="type-statements"><a href="#type-statements" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>statements</code><code><span class="keyword"> = </span><a href="index.html#type-statement">statement</a> list</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-guarded_var_i"><a href="#type-guarded_var_i" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>guarded_var_i</code><code></code><code></code></div><div class="doc"><p>the type of variables in guarded assignments</p></div></div><div class="spec class" id="class-variable"><a href="#class-variable" class="anchor"></a><div class="def class"><code><span class="keyword">class </span><a href="class-variable/index.html">variable</a> : <a href="index.html#type-guarded_var_i">guarded_var_i</a><span class="keyword"> -&gt; </span><span class="keyword">object</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec type" id="type-case"><a href="#type-case" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a case</code><code><span class="keyword"> = </span><span class="type-var">'a</span><span class="keyword"> * </span><a href="index.html#type-statements">statements</a></code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-cases"><a href="#type-cases" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a cases</code><code><span class="keyword"> = </span><span class="type-var">'a</span> <a href="index.html#type-case">case</a> list</code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-g_wire"><a href="#val-g_wire" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_wire : <a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="index.html#class-variable">variable</a></code></div><div class="doc"><p>create a wire</p></div></div><div class="spec val" id="val-g_reg"><a href="#val-g_reg" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_reg : <a href="../Types/index.html#type-register">Types.register</a><span class="keyword"> -&gt; </span><a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span>int<span class="keyword"> -&gt; </span><a href="index.html#class-variable">variable</a></code></div><div class="doc"><p>create a register</p></div></div><div class="spec val" id="val-g_var"><a href="#val-g_var" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_var : <a href="../Types/index.html#type-register">Types.register</a><span class="keyword"> -&gt; </span><a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span>int<span class="keyword"> -&gt; </span><a href="index.html#class-variable">variable</a></code></div><div class="doc"><p>create a register with variable semantics</p></div></div><div class="spec val" id="val-g_pipeline"><a href="#val-g_pipeline" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_pipeline : int<span class="keyword"> -&gt; </span><a href="../Types/index.html#type-register">Types.register</a><span class="keyword"> -&gt; </span><a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span>int<span class="keyword"> -&gt; </span><a href="index.html#class-variable">variable</a></code></div><div class="doc"><p>create a pipeline of registers</p></div></div><div class="spec val" id="val-g_if"><a href="#val-g_if" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_if : <a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>if statement</p></div></div><div class="spec val" id="val-g_elif"><a href="#val-g_elif" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_elif : <a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a></code></div><div class="doc"><p>else if branch</p></div></div><div class="spec val" id="val-g_when"><a href="#val-g_when" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_when : <a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>if sel then <code class="code">...</code> else <code class="code"></code></p></div></div><div class="spec val" id="val-g_unless"><a href="#val-g_unless" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_unless : <a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>if sel then <code class="code"></code> else <code class="code">...</code></p></div></div><div class="spec val" id="val-g_switch"><a href="#val-g_switch" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_switch : <a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="../Types/index.html#type-signal">Types.signal</a> <a href="index.html#type-cases">cases</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>switch statement</p></div></div><div class="spec val" id="val-g_proc"><a href="#val-g_proc" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>g_proc : <a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>allows sequences of expressions to be inserted into the code. a
syntactic nicety.</p></div></div><div class="spec val" id="val-($==)"><a href="#val-($==)" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>($==) : <a href="index.html#class-variable">variable</a><span class="keyword"> -&gt; </span><a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>assignment</p></div></div><div class="spec val" id="val-($==.)"><a href="#val-($==.)" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>($==.) : <a href="index.html#class-variable">variable</a><span class="keyword"> -&gt; </span>int<span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a></code></div><div class="doc"><p>assignment with an integer constant - width is inferred</p></div></div><div class="spec val" id="val-compile"><a href="#val-compile" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>compile : <a href="index.html#type-statements">statements</a><span class="keyword"> -&gt; </span>unit</code></div><div class="doc"><p>compile statements to structural code</p></div></div><div class="spec val" id="val-statemachine"><a href="#val-statemachine" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>statemachine : <a href="../Types/index.html#type-register">Types.register</a><span class="keyword"> -&gt; </span><a href="../Types/index.html#type-signal">Types.signal</a><span class="keyword"> -&gt; </span><span class="type-var">'a</span> list<span class="keyword"> -&gt; </span><a href="index.html#class-variable">variable</a><span class="keyword"> * </span>(<span class="type-var">'a</span> <a href="index.html#type-cases">cases</a><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a>)<span class="keyword"> * </span>(<span class="type-var">'a</span><span class="keyword"> -&gt; </span><a href="index.html#type-statement">statement</a>)</code></div><div class="doc"><p>statemachine abstraction</p></div></div></body></html>