FROM hardcaml-docs-base

RUN opam pin add -n lambda-term        git://github.com/andrewray/lambda-term#move-focus
RUN opam pin add -n vg                 git://github.com/ujamjar/vg
RUN opam pin add -n sattools           git://github.com/ujamjar/sattools
RUN opam pin add -n hardcaml           git://github.com/ujamjar/hardcaml
RUN opam pin add -n hardcaml-waveterm  git://github.com/ujamjar/hardcaml-waveterm#widget
RUN opam pin add -n hardcaml-examples  git://github.com/ujamjar/hardcaml-examples
#RUN opam pin add -n hardcaml-llvmsim   git://github.com/ujamjar/hardcaml-llvmsim
RUN opam pin add -n hardcaml-bloop     git://github.com/ujamjar/hardcaml-bloop
RUN opam pin add -n hardcaml-affirm    git://github.com/ujamjar/hardcaml-affirm
RUN opam pin add -n hardcaml-yosys     git://github.com/ujamjar/hardcaml-yosys

RUN opam depext -uivj 3 hardcaml hardcaml-examples hardcaml-affirm hardcaml-yosys #hardcaml-llvmsim

# to get list of required packages (remove subpackages)
#ocamlfind query -r hardcaml hardcaml-waveterm hardcaml-examples hardcaml-affirm hardcaml-yosys -p-format
RUN opam config exec -- odig odoc \
  bytes unix bigarray num hardcaml hardcaml-waveterm hardcaml-framework \
  hardcaml-examples sattools bdd uutf gg vg hardcaml-bloop lwt \
  react camomile zed lambda-term hardcaml-affirm str easy-format \
  atd biniou yojson atdgen hardcaml-yosys

#EXPOSE 7777
#ENTRYPOINT opam config exec -- cohttp-server-lwt -p 7777 /home/opam/.opam/4.03.0/var/cache/odig


