<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Guarded (hardcaml.Signal.Guarded)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/></head><body><div class="odoc-doc"><a href="../index.html">Up</a><div class="intro"><h1><span class="keyword">Module </span><a href="../#/Guarded">Guarded</a></h1></div><div class="mod"><div class="def"><span class="keyword">module </span>Guarded : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Guarded assignments.<br/>Allows code to be written in a similar manner to verilog always or vhdl
process blocks. 'if' and 'switch' control constructs are provided. ($==)
is used for assignment.<br/>Code is written as lists of assignments, if and control statements.<br/>variables;<br/><pre>
    let var = g_wire (zero 8) in
    let var = g_reg r_sync enable 8 in
</pre><br/>assignment;<br/><pre>
    var $== exp;
</pre><br/>if statements;<br/><pre>
    g_if condition [ ... ] [ ... ]
</pre><br/>switch statements;<br/><pre>
    g_switch condition [
    consti 3 0 [ ... ]
    consti 3 1 [ ... ]
    consti 3 2 [ ... ]
    consti 3 3 [ ... ]
    ]
</pre><br/>signals;<br/><pre>
    let (s:signal) = q (v:guarded) in
</pre><br/>compilation;<br/><pre>
    compile [ ... ]
</pre><br/>example;<br/><pre>
    let state = g_reg r_sync enable 2 in
    let a = g_wire 8 in
    compile [
        g_if (q a) ==: consti 8 4 [
            a $== consti 8 2
        ]
        g_switch (q state) [
            (consti 2 0) [
                a $== 3;
                state $== const 2 1;
            ]
            (consti 2 1) [
                a $== 2;
                state $== const 2 2;
            ]
            (consti 2 2) [
                a $== 1;
                state $== const 2 3;
            ]
            (consti 2 3) [
                a $== 0;
                state $== const 2 4;
            ]
        ]
    ]
    let state = q state in
    let a = q a in
    ....
</pre></div><hr/><div><div class="region" id="/statement.typ"><a href="#/statement.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>statement</div><div class="doc">the type of statements in guarded assigments</div></div></div><div class="region" id="/statements.typ"><a href="#/statements.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>statements = <a href="index.html#/statement.typ">statement</a> list</div><div class="doc"></div></div></div><div class="region" id="/guarded_var_i.typ"><a href="#/guarded_var_i.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>guarded_var_i</div><div class="doc">the type of variables in guarded assignments</div></div></div><div class="class"><div class="def"><span class="keyword">class </span>variable</div><div class="doc"></div></div><div class="region" id="/case.typ"><a href="#/case.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>'a case = 'a * <a href="index.html#/statements.typ">statements</a></div><div class="doc"></div></div></div><div class="region" id="/cases.typ"><a href="#/cases.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>'a cases = 'a <a href="index.html#/case.typ">case</a> list</div><div class="doc"></div></div></div><div class="region" id="/g_wire.val"><a href="#/g_wire.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_wire : <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; variable</div><div class="doc">create a wire</div></div></div><div class="region" id="/g_reg.val"><a href="#/g_reg.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_reg : <a href="../Types/index.html#/register.typ">Types.register</a> -&gt; <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; int -&gt; variable</div><div class="doc">create a register</div></div></div><div class="region" id="/g_var.val"><a href="#/g_var.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_var : <a href="../Types/index.html#/register.typ">Types.register</a> -&gt; <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; int -&gt; variable</div><div class="doc">create a register with variable semantics</div></div></div><div class="region" id="/g_pipeline.val"><a href="#/g_pipeline.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_pipeline : int -&gt; <a href="../Types/index.html#/register.typ">Types.register</a> -&gt; <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; int -&gt; variable</div><div class="doc">create a pipeline of registers</div></div></div><div class="region" id="/g_if.val"><a href="#/g_if.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_if : <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">if statement</div></div></div><div class="region" id="/g_elif.val"><a href="#/g_elif.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_elif : <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statements.typ">statements</a></div><div class="doc">else if branch</div></div></div><div class="region" id="/g_when.val"><a href="#/g_when.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_when : <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">if sel then <code>...</code> else <code></code></div></div></div><div class="region" id="/g_unless.val"><a href="#/g_unless.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_unless : <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">if sel then <code></code> else <code>...</code></div></div></div><div class="region" id="/g_switch.val"><a href="#/g_switch.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_switch : <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; <a href="../Types/index.html#/signal.typ">Types.signal</a> <a href="index.html#/cases.typ">cases</a> -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">switch statement</div></div></div><div class="region" id="/g_proc.val"><a href="#/g_proc.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>g_proc : <a href="index.html#/statements.typ">statements</a> -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">allows sequences of expressions to be inserted into the code. a
syntactic nicety.</div></div></div><div class="region" id="/($==).val"><a href="#/($==).val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>($==) : variable -&gt; <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">assignment</div></div></div><div class="region" id="/($==.).val"><a href="#/($==.).val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>($==.) : variable -&gt; int -&gt; <a href="index.html#/statement.typ">statement</a></div><div class="doc">assignment with an integer constant - width is inferred</div></div></div><div class="region" id="/compile.val"><a href="#/compile.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>compile : <a href="index.html#/statements.typ">statements</a> -&gt; unit</div><div class="doc">compile statements to structural code</div></div></div><div class="region" id="/statemachine.val"><a href="#/statemachine.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>statemachine : <a href="../Types/index.html#/register.typ">Types.register</a> -&gt; <a href="../Types/index.html#/signal.typ">Types.signal</a> -&gt; 'a list -&gt; variable * ('a <a href="index.html#/cases.typ">cases</a> -&gt; <a href="index.html#/statement.typ">statement</a>) * ('a -&gt; <a href="index.html#/statement.typ">statement</a>)</div><div class="doc">statemachine abstraction</div></div></div></div></div></div></body></html>