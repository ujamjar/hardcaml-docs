<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>LTerm_history (lambda-term.LTerm_history)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/></head><body><div class="odoc-doc"><a href="../index.html">Up</a><div class="intro"><h1><span class="keyword">Module </span><a href="../#/LTerm_history">LTerm_history</a></h1></div><div><div class="doc">History management</div><div><div class="region" id="/t.typ"><a href="#/t.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>t</div><div class="doc">Type of a history.</div></div></div><div class="region" id="/create.val"><a href="#/create.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>create : ?max_size:int -&gt; ?max_entries:int -&gt; <a href="../../zed/Zed_utf8/index.html#/t.typ">Zed_utf8.t</a> list -&gt; <a href="index.html#/t.typ">t</a></div><div class="doc"><code>create ?max_size ?max_lines init</code> creates a new history.<br/><code>max_size</code> is the maximum size in bytes of the history. Oldest
entries are dropped if this limit is reached. The default is
<code>max_int</code>.<br/><code>max_entries</code> is the maximum number of entries of the
history. Oldest entries are dropped if this limit is
reached. The default is no <code>max_int</code>.<br/><code>init</code> is the initial contents of the history. All entries of
<code>init</code> are considered &quot;old&quot;. Old entries are not saved by
save when <code>append</code> is set to <code>true</code>.<br/>Note: the first element of <code>init</code> must be the most recent
entry.</div></div></div><div class="region" id="/add.val"><a href="#/add.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>add : <a href="index.html#/t.typ">t</a> -&gt; ?skip_empty:bool -&gt; ?skip_dup:bool -&gt; <a href="../../zed/Zed_utf8/index.html#/t.typ">Zed_utf8.t</a> -&gt; unit</div><div class="doc"><code>add history ?skip_empty ?skip_dup entry</code> adds <code>entry</code> to the
top of the history. If <code>skip_empty</code> is <code>true</code> (the default) and
<code>entry</code> contains only spaces, it is not added. If <code>skip_dup</code> is
<code>true</code> (the default) and <code>entry</code> is equal to the top of the
history, it is not added.<br/>If <code>entry</code> is bigger than the maximum size of the history, the
history is not modified.</div></div></div><div class="region" id="/contents.val"><a href="#/contents.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>contents : <a href="index.html#/t.typ">t</a> -&gt; <a href="../../zed/Zed_utf8/index.html#/t.typ">Zed_utf8.t</a> list</div><div class="doc">Returns all the entries of the history. The first element of the
list is the most recent entry.</div></div></div><div class="region" id="/size.val"><a href="#/size.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>size : <a href="index.html#/t.typ">t</a> -&gt; int</div><div class="doc">Returns the size (in bytes) of the history.</div></div></div><div class="region" id="/length.val"><a href="#/length.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>length : <a href="index.html#/t.typ">t</a> -&gt; int</div><div class="doc">Returns the number of entries in the history.</div></div></div><div class="region" id="/old_count.val"><a href="#/old_count.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>old_count : <a href="index.html#/t.typ">t</a> -&gt; int</div><div class="doc">Returns the number of old entries in the history.</div></div></div><div class="region" id="/set_old_count.val"><a href="#/set_old_count.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>set_old_count : <a href="index.html#/t.typ">t</a> -&gt; int -&gt; unit</div><div class="doc"><code>set_old_count history count</code> sets the number of old entries in
the history.</div></div></div><div class="region" id="/max_size.val"><a href="#/max_size.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>max_size : <a href="index.html#/t.typ">t</a> -&gt; int</div><div class="doc">Returns the maximum size of the history.</div></div></div><div class="region" id="/set_max_size.val"><a href="#/set_max_size.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>set_max_size : <a href="index.html#/t.typ">t</a> -&gt; int -&gt; unit</div><div class="doc">Sets the maximum size of the history. It may drop oldest entries
to honor the new limit.</div></div></div><div class="region" id="/max_entries.val"><a href="#/max_entries.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>max_entries : <a href="index.html#/t.typ">t</a> -&gt; int</div><div class="doc">Returns the maximum number of entries of the history.</div></div></div><div class="region" id="/set_max_entries.val"><a href="#/set_max_entries.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>set_max_entries : <a href="index.html#/t.typ">t</a> -&gt; int -&gt; unit</div><div class="doc">Sets the maximum number of entries of the history. It may drop
oldest entries to honor the new limit.</div></div></div><div class="region" id="/load.val"><a href="#/load.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>load : <a href="index.html#/t.typ">t</a> -&gt; ?log:(int -&gt; string -&gt; unit) -&gt; ?skip_empty:bool -&gt; ?skip_dup:bool -&gt; string -&gt; unit <a href="../../lwt/Lwt/index.html#/t.typ">Lwt.t</a></div><div class="doc"><code>load history ?log ?skip_empty ?skip_dup filename</code> loads entries
from <code>filename</code> to <code>history</code>. If <code>filename</code> does not exists
<code>history</code> is not modified.<br/><code>log</code> is the function used to log errors contained in the
history file (errors are because of non-UTF8 data). Arguments
are a line number and an error message. The default is to use
the default logger (of <code>Lwt_log</code>). Entries containing errors are
skipped.<br/>Note: all entries are marked as old, i.e. <code>old_count history =
      length history</code>.</div></div></div><div class="region" id="/save.val"><a href="#/save.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>save : <a href="index.html#/t.typ">t</a> -&gt; ?max_size:int -&gt; ?max_entries:int -&gt; ?skip_empty:bool -&gt; ?skip_dup:bool -&gt; ?append:bool -&gt; ?perm:int -&gt; string -&gt; unit <a href="../../lwt/Lwt/index.html#/t.typ">Lwt.t</a></div><div class="doc"><code>save history ?max_size ?max_entries ?skip_empty ?sjip_dup ?perm
      filename</code> saves <code>history</code> to <code>filename</code>.<br/>If <code>append</code> is <code>false</code> then the file is truncated and new
entries are saved. If it is <code>true</code> (the default) then new
entries are added at the end. <code>perm</code> are the file permissions in
case it is created.<br/>If <code>append</code> is <code>true</code> and there is no new entries, the file is
not touched. In any other case, limits are honored and the
resulting file will never contains more bytes than <code>max_size</code> or
more entries than <code>max_entries</code>. If <code>max_size</code> and/or
<code>max_entries</code> are not specified, the ones of <code>history</code> are used.<br/>After the history is successfully saved, all entries of
<code>history</code> are marked as old, i.e. <code>old_count history = length
      history</code>.</div></div></div><div class="region" id="/entry_size.val"><a href="#/entry_size.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>entry_size : <a href="../../zed/Zed_utf8/index.html#/t.typ">Zed_utf8.t</a> -&gt; int</div><div class="doc"><code>entry_size entry</code> returns the size taken by an entry in the
history file in bytes. This is not exactly <code>String.length entry</code>
since some characters are escaped and the entry is terminated by
a newline character.</div></div></div></div></div></div></body></html>