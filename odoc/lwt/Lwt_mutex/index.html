<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lwt_mutex (lwt.Lwt_mutex)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/></head><body><div class="odoc-doc"><a href="../index.html">Up</a><div class="intro"><h1><span class="keyword">Module </span><a href="../#/Lwt_mutex">Lwt_mutex</a></h1></div><div><div class="doc">Cooperative locks for mutual exclusion</div><div><div class="region" id="/t.typ"><a href="#/t.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>t</div><div class="doc">Type of Lwt mutexes</div></div></div><div class="region" id="/create.val"><a href="#/create.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>create : unit -&gt; <a href="index.html#/t.typ">t</a></div><div class="doc"><code>create ()</code> creates a new mutex, which is initially unlocked</div></div></div><div class="region" id="/lock.val"><a href="#/lock.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>lock : <a href="index.html#/t.typ">t</a> -&gt; unit <a href="../Lwt/index.html#/t.typ">Lwt.t</a></div><div class="doc"><code>lock mutex</code> lockcs the mutex, that is:<br/><ul><li>if the mutex is unlocked, then it is marked as locked and
lock returns immediately</li></ul><ul><li>if it is locked, then lock waits for all threads waiting on
the mutex to terminate, then it resumes when the last one
unlocks the mutex</li></ul>Note: threads are woken up in the same order they try to lock the
mutex</div></div></div><div class="region" id="/unlock.val"><a href="#/unlock.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>unlock : <a href="index.html#/t.typ">t</a> -&gt; unit</div><div class="doc"><code>unlock mutex</code> unlock the mutex if no threads is waiting on
it. Otherwise it will eventually removes the first one and
resumes it.</div></div></div><div class="region" id="/is_locked.val"><a href="#/is_locked.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>is_locked : <a href="index.html#/t.typ">t</a> -&gt; bool</div><div class="doc"><code>locked mutex</code> returns whether <code>mutex</code> is currently locked</div></div></div><div class="region" id="/is_empty.val"><a href="#/is_empty.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>is_empty : <a href="index.html#/t.typ">t</a> -&gt; bool</div><div class="doc"><code>is_empty mutex</code> returns <code>true</code> if they are no thread waiting on
the mutex, and <code>false</code> otherwise</div></div></div><div class="region" id="/with_lock.val"><a href="#/with_lock.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>with_lock : <a href="index.html#/t.typ">t</a> -&gt; (unit -&gt; 'a <a href="../Lwt/index.html#/t.typ">Lwt.t</a>) -&gt; 'a <a href="../Lwt/index.html#/t.typ">Lwt.t</a></div><div class="doc"><code>with_lock lock f</code> is used to lock a mutex within a block scope.
The function <code>f ()</code> is called with the mutex locked, and its
result is returned from the call to <span style="with_lock"></span>. If an exception
is raised from f, the mutex is also unlocked before the scope of
<span style="with_lock"></span> is exited.</div></div></div></div></div></div></body></html>