<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Private (vg.Vg.Vgr.Private)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/></head><body><div class="odoc-doc"><a href="../index.html">Up</a><div class="intro"><h1><span class="keyword">Module </span><a href="../#/Private">Private</a></h1></div><div class="mod"><div class="def"><span class="keyword">module </span>Private : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Private functions for implementing renderers.<br/><span style="font-weight: bold">Warning.</span>
<code>Vg</code> users should not use these definitions, they exposes <code>Vg</code>'s
internals for implementing renderers. This functionality is
subject to change even between minor versions of the
library.<br/>In order to provide a consistant interface for <code>Vg</code> users,
renderer writers should follow the guidelines below. You may
want to drop an email to Daniel BÃ¼nzli &lt;daniel.buenzl i@erratique.ch&gt; for help and discussion.
<ul><li>If you render to &quot;Bla&quot;, define you renderer in a module
called <code>Vgr_bla</code> (lowercase).</li><li>The renderer target creation function must be named
<code>Vgr_bla.target</code>.</li><li>Images must be rendered via the render function. If you
are writing a batch renderer provide support for each of the
<a href="index.html#/dst.typ">dst</a> types and especially the non-blocking interface.</li><li>Respect Vg's linear sRGB color model.</li><li>Whenever possible use an XMP metadata packet for metadata,
see Vgr.xmp.</li><li>The renderer should implement the rendering cost model,
see the <code>limit</code> parameter of render.</li><li>Follow <code>Vg</code>'s
coordinates to
specify the relationship between a target and the view
rectangle to render.</li><li>If the renderer doesn't support <code>Vg</code>'s full rendering model or
diverges from its semantics it must ignore unsupported features
and warn the client via the warn function.</li></ul></div><hr/><div><div class="doc"><h1>Internal data</h1></div><div class="region" id="/Data"><a href="#/Data" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Data/index.html">Data</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Internal data.</div></div></div><div class="region" id="/Font"><a href="#/Font" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Font/index.html">Font</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Font helpers.</div></div></div><div class="region" id="/P"><a href="#/P" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="P/index.html">P</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Paths helpers.</div></div></div><div class="region" id="/I"><a href="#/I" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="I/index.html">I</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Image helpers</div></div></div><div class="doc"><h1>Renderers</h1></div><div class="region" id="/renderer.typ"><a href="#/renderer.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>renderer</div><div class="doc">The type for renderers.</div></div></div><div class="region" id="/k.typ"><a href="#/k.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>k = <a href="index.html#/renderer.typ">renderer</a> -&gt; [ `Ok | `Partial ]</div><div class="doc">The type for renderer continuations.</div></div></div><div class="region" id="/render_fun.typ"><a href="#/render_fun.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>render_fun = [ `End | `Image of <a href="../../../../gg/Gg/index.html#/size2.typ">Gg.size2</a> * <a href="../../../../gg/Gg/index.html#/box2.typ">Gg.box2</a> * <a href="Data/index.html#/image.typ">Data.image</a> ] -&gt; <a href="index.html#/k.typ">k</a> -&gt; <a href="index.html#/k.typ">k</a></div><div class="doc">The type for rendering functions.</div></div></div><div class="region" id="/render_target.typ"><a href="#/render_target.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>'a render_target = <a href="index.html#/renderer.typ">renderer</a> -&gt; 'a -&gt; bool * <a href="index.html#/render_fun.typ">render_fun</a><span class="keyword"> constraint </span>'a = [&lt; <a href="../index.html#/dst.typ">dst</a> ]</div><div class="doc">The type for render targets. The function takes a created
renderer and its destination. It should return a boolean
indicating whether multiple images can be rendered on the
target, and a function that is invoked by the renderer to
render a new image or end the rendering sequence.</div></div></div><div class="region" id="/create_target.val"><a href="#/create_target.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>create_target : 'a <a href="index.html#/render_target.typ">render_target</a> -&gt; 'a <a href="../index.html#/target.typ">target</a></div><div class="doc"><code>create_target t</code> makes an end-user render target from <code>t</code>.</div></div></div><div class="region" id="/renderer.val"><a href="#/renderer.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>renderer : <a href="../index.html#/t.typ">t</a> -&gt; <a href="index.html#/renderer.typ">renderer</a></div><div class="doc"><code>renderer r</code> is <code>r</code>'s internal representation.</div></div></div><div class="region" id="/limit.val"><a href="#/limit.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>limit : <a href="index.html#/renderer.typ">renderer</a> -&gt; int</div><div class="doc"><code>limit r</code> is <code>r</code>'s render limit.</div></div></div><div class="region" id="/warn.val"><a href="#/warn.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>warn : <a href="index.html#/renderer.typ">renderer</a> -&gt; <a href="../index.html#/warning.typ">warning</a> -&gt; unit</div><div class="doc"><code>warn r w</code> reports the warning <code>w</code> on <code>r</code>.</div></div></div><div class="region" id="/partial.val"><a href="#/partial.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>partial : <a href="index.html#/k.typ">k</a> -&gt; <a href="index.html#/renderer.typ">renderer</a> -&gt; [&gt; `Partial ]</div><div class="doc"><code>partial k r</code> suspends the renderer <code>r</code> and returns <code>`Partial</code>.
Rendering will continue with <code>k r</code>, on render <code>`Await</code>.</div></div></div><div class="doc"><h1>Writing <a href="../index.html#/dst_stored.typ">dst_stored</a> destinations</h1></div><div class="region" id="/flush.val"><a href="#/flush.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>flush : <a href="index.html#/k.typ">k</a> -&gt; <a href="index.html#/renderer.typ">renderer</a> -&gt; [ `Ok | `Partial ]</div><div class="doc"><code>flush k r</code> flushes the renderer <code>r</code>. If <code>r</code> writes
on a stored destination this function <span style="font-weight: bold">must</span> be called
by the rendering function on <code>`End</code>.</div></div></div><div class="region" id="/writeb.val"><a href="#/writeb.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>writeb : int -&gt; <a href="index.html#/k.typ">k</a> -&gt; <a href="index.html#/renderer.typ">renderer</a> -&gt; [ `Ok | `Partial ]</div><div class="doc"><code>writeb b k r</code> writes the byte <code>b</code> and <code>k</code>ontinues.</div></div></div><div class="region" id="/writes.val"><a href="#/writes.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>writes : string -&gt; int -&gt; int -&gt; <a href="index.html#/k.typ">k</a> -&gt; <a href="index.html#/renderer.typ">renderer</a> -&gt; [ `Ok | `Partial ]</div><div class="doc"><code>writes s j l k r</code> writes <code>l</code> bytes from <code>s</code> starting at <code>j</code>
and <code>k</code>ontinues.</div></div></div><div class="region" id="/writebuf.val"><a href="#/writebuf.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>writebuf : <a href="../../../../ocaml/Buffer/index.html#/t.typ">Buffer.t</a> -&gt; int -&gt; int -&gt; <a href="index.html#/k.typ">k</a> -&gt; <a href="index.html#/renderer.typ">renderer</a> -&gt; [ `Ok | `Partial ]</div><div class="doc"><code>writebuf buf j l k r</code> write <code>l</code> bytes from <code>buf</code> starting at <code>j</code>
and <code>k</code>ontinues.</div></div></div><div class="doc"><h1>Miscellaneous</h1></div><div class="region" id="/add_xml_data.val"><a href="#/add_xml_data.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>add_xml_data : <a href="../../../../ocaml/Buffer/index.html#/t.typ">Buffer.t</a> -&gt; string -&gt; unit</div><div class="doc"><code>add_xml_data b s</code> adds <code>s</code> to <code>b</code>, escapes
<code>'&lt;', '&gt;', '&amp;'</code> and <code>'&quot;'</code> (but <span style="font-weight: bold">not</span> single quotes) and
maps illegal XML unicode characters to the replacement character
U+FFFD.</div></div></div></div></div></div></body></html>