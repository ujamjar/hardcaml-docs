<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Vgr (vg.Vg.Vgr)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/></head><body><div class="odoc-doc"><a href="../index.html">Up</a><div class="intro"><h1><span class="keyword">Module </span><a href="../#/Vgr">Vgr</a></h1></div><div class="mod"><div class="def"><span class="keyword">module </span>Vgr : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Image renderers.<br/>Renderers renders finite rectangular regions of images on
rectangular targets. The following renderers are distributed with
the library:
<ul><li>Vgr_pdf, renders sequence of images as a multi-page PDF 1.7 document.</li><li>Vgr_svg, renders a single image as an
<a href="http://www.w3.org/TR/SVG11/">SVG 1.1</a> document.</li><li>Vgr_htmlc, renders sequence of images on an
<a href="http://www.w3.org/TR/2dcontext/">HTML canvas</a>
via <a href="http://ocsigen.org/js_of_ocaml/">js_of_ocaml</a>.</li><li>Vgr_cairo, renders images using the
<a href="http://cairographics.org/">Cairo</a> library.</li></ul></div><hr/><div><div class="doc"><h1 id="warnings">Render warnings</h1><br/>Renderers do their best to support <code>Vg</code>'s rendering model and
semantics. However they may sometimes lack capabilities provided
by <code>Vg</code>'s rendering model.<br/>Whenever a renderer encounters an unsupported capability it
ignores it and calls the <code>warn</code> callback specified at renderer
Vgr.create time. The documentation of renderers
indicate which warnings they report.</div><div class="region" id="/warning.typ"><a href="#/warning.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>warning = [ `Unsupported_cut of <a href="../P/index.html#/area.typ">P.area</a> * <a href="../I/index.html#/t.typ">I.t</a> | `Unsupported_glyph_cut of <a href="../P/index.html#/area.typ">P.area</a> * <a href="../I/index.html#/t.typ">I.t</a> | `Textless_glyph_cut of <a href="../I/index.html#/t.typ">I.t</a> | `Other of string ]</div><div class="doc">The type for render warnings.</div></div></div><div class="region" id="/pp_warning.val"><a href="#/pp_warning.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>pp_warning : <a href="../../../ocaml/Format/index.html#/formatter.typ">Format.formatter</a> -&gt; <a href="index.html#/warning.typ">warning</a> -&gt; unit</div><div class="doc"><code>pp_warning ppf w</code> prints a textual representation of <code>w</code> on <code>ppf</code>.</div></div></div><div class="region" id="/warn.typ"><a href="#/warn.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>warn = <a href="index.html#/warning.typ">warning</a> -&gt; unit</div><div class="doc">The type for warning callbacks.</div></div></div><div class="doc"><h1 id="metadata">Render metadata</h1><br/>Some renderers support the specification of metadata as an XML
<a href="http://www.adobe.com/devnet/xmp.html">XMP metadata</a> packet
(ISO 16684-1).
The following convenience function returns a well-formed, correctly
escaped, metadata packet according to the information you provide.</div><div class="region" id="/xmp.val"><a href="#/xmp.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>xmp : ?title:string -&gt; ?authors:string list -&gt; ?subjects:string list -&gt; ?description:string -&gt; ?rights:string -&gt; ?creator_tool:string -&gt; ?create_date:float -&gt; unit -&gt; string</div><div class="doc"><code>xmp title authors creator_tool subject description create_date</code>
is an XML XMP metadata packet.
<ul><li><code>title</code> is mapped to dc:title.</li><li><code>authors</code> is mapped to dc:creator.</li><li><code>subjects</code> is mapped to dc:subject.</li><li><code>description</code> is mapped to dc:description.</li><li><code>rights</code> is mapped to dc:rights.</li><li><code>creator_tool</code> is mapped to xmp:CreatorTool.</li><li><code>create_date</code> (a POSIX timestamp in seconds) is mapped to
xmp:CreateDate.</li></ul><br/><span style="font-weight: bold">Note.</span> All strings must be UTF-8 encoded. Unicode characters
that are not legal XML
<a href="http://www.w3.org/TR/REC-xml/#NT-Char">characters</a> are
replaced by the Unicode
<a href="http://unicode.org/glossary/#replacement_character">replacement
character</a></div></div></div><div class="doc"><h1 id="renderable">Renderable</h1><br/>A renderable specifies a finite view rectangle and a physical
size for an image render. It implicitly defines the mapping
between <code>Vg</code>'s coordinate space and the render target, see
coordinates for more information.</div><div class="region" id="/renderable.typ"><a href="#/renderable.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>renderable = <a href="../../../gg/Gg/index.html#/size2.typ">Gg.size2</a> * <a href="../../../gg/Gg/index.html#/box2.typ">Gg.box2</a> * <a href="../index.html#/image.typ">image</a></div><div class="doc">The type for renderables. The physical size on the render target
in millimeters, the view rectangle and the image to render.</div></div></div><div class="doc"><h1 id="render">Rendering</h1></div><div class="region" id="/dst_stored.typ"><a href="#/dst_stored.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>dst_stored = [ `Buffer of <a href="../../../ocaml/Buffer/index.html#/t.typ">Buffer.t</a> | `Channel of <a href="../../../ocaml/Pervasives/index.html#/out_channel.typ">Pervasives.out_channel</a> | `Manual ]</div><div class="doc">The type for stored renderer destination. With a <code>`Manual</code>
destination the client must provide output storage see
Manual.dst.</div></div></div><div class="region" id="/dst.typ"><a href="#/dst.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>dst = [ <a href="index.html#/dst_stored.typ">dst_stored</a> | `Other ]</div><div class="doc">The type for renderer destinations. Either a stored destination
or an <code>`Other</code> destination, usually denoting some kind of
interactive renderer.</div></div></div><div class="region" id="/target.typ"><a href="#/target.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>'a target<span class="keyword"> constraint </span>'a = [&lt; <a href="index.html#/dst.typ">dst</a> ]</div><div class="doc">The type for render targets. The type parameter specifies the supported
type of destinations. Values of this type are provided by concrete
renderer implementation.</div></div></div><div class="region" id="/t.typ"><a href="#/t.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>t = <a href="../index.html#/renderer.typ">renderer</a></div><div class="doc">The type for renderers.</div></div></div><div class="region" id="/create.val"><a href="#/create.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>create : ?limit:int -&gt; ?warn:<a href="index.html#/warn.typ">warn</a> -&gt; [&lt; <a href="index.html#/dst.typ">dst</a> ]<span class="keyword"> as </span>dst <a href="index.html#/target.typ">target</a> -&gt; 'dst -&gt; <a href="../index.html#/renderer.typ">renderer</a></div><div class="doc"><code>create limit warn target dst</code> is a renderer using <code>target</code> to render
images to <code>dst</code>. <code>warn</code> is called whenever the renderer lacks a
capability, see warnings.<br/><code>limit</code> limits the time spent in the render function (defaults to
<code>max_int</code>, unlimited). The cost model may change in a future
version of the library. For now each image combinator costs one
unit, when the limit is reached render returns with
<code>`Partial</code>.</div></div></div><div class="region" id="/render.val"><a href="#/render.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>render : <a href="../index.html#/renderer.typ">renderer</a> -&gt; [&lt; `Image of <a href="index.html#/renderable.typ">renderable</a> | `Await | `End ] -&gt; [ `Ok | `Partial ]</div><div class="doc"><code>render r v</code> is:
<ul><li><code>`Partial</code> iff <code>r</code> has a <code>`Manual</code> destination and needs more
output storage or if <code>r</code> has a limit. In the first
case the client must use Manual.dst to provide
a new buffer. In both cases the client should then
call render with <code>`Await</code> until
<code>`Ok</code> is returned.</li><li><code>`Ok</code> when the encoder is ready to encode a new <code>`Image</code> (if
the renderer supports it) or <code>`End</code>.</li></ul> For <code>`Manual</code>
destinations, encoding <code>`End</code> always returns <code>`Partial</code> the
client should as usual use Manual.dst and continue with
<code>`Await</code> until <code>`Ok</code> is returned at which point
Manual.dst_rem<code> r</code> is guaranteed to be the size of the
last provided buffer (i.e. nothing was written).<br/><span style="font-weight: bold">Semantics of multiple images render.</span> The semantics
of multiple image renders are left to the backend.</div></div></div><div class="region" id="/renderer_dst.val"><a href="#/renderer_dst.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>renderer_dst : <a href="../index.html#/renderer.typ">renderer</a> -&gt; <a href="index.html#/dst.typ">dst</a></div><div class="doc"><code>render_dst r</code> is <code>r</code>'s destination.</div></div></div><div class="region" id="/renderer_limit.val"><a href="#/renderer_limit.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>renderer_limit : <a href="../index.html#/renderer.typ">renderer</a> -&gt; int</div><div class="doc"><code>renderer_limit r</code> is <code>r</code>'s limit.</div></div></div><div class="doc"><h1>Manual render destinations</h1></div><div class="region" id="/Manual"><a href="#/Manual" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Manual/index.html">Manual</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Manual render destinations.</div></div></div><div class="doc"><h1 id="renderer">Implementing renderers</h1></div><div class="region" id="/Private"><a href="#/Private" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Private/index.html">Private</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc">Private functions for implementing renderers.</div></div></div></div></div></div></body></html>