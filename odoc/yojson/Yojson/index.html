<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Yojson (yojson.Yojson)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/></head><body><div class="odoc-doc"><a href="../index.html">Up</a><div class="intro"><h1><span class="keyword">Module </span><a href="../#/Yojson">Yojson</a></h1></div><div><div class="doc">The Yojson library provides runtime functions for reading and writing JSON
data from OCaml. It addresses a few shortcomings of its predecessor
json-wheel and is about twice as fast (2.7x reading, 1.3x writing; results
may vary).
The design goals of Yojson are the following:
<ul><li>Reducing inter-package dependencies by the use of polymorphic
variants for the JSON tree type.</li><li>Allowing type-aware serializers/deserializers
to read and write directly without going through a generic JSON tree,
for efficiency purposes.
Readers and writers of all JSON syntaxic elements are provided
but are undocumented and meant to be used by generated OCaml code.</li><li>Distinguishing between ints and floats.</li><li>Providing optional extensions of the JSON syntax.
These extensions include comments, arbitrary strings,
optional quotes around field names, tuples and variants.</li></ul></div><div><div class="doc"><h1>Shared types and functions</h1></div><div class="region" id="/version.val"><a href="#/version.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>version : string</div><div class="doc"></div></div></div><div class="exn"><div class="def"><span class="keyword">exn </span>Json_error of string</div><div class="doc"></div></div><div class="region" id="/json_error.val"><a href="#/json_error.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>json_error : string -&gt; 'a</div><div class="doc"></div></div></div><div class="region" id="/lexer_state.typ"><a href="#/lexer_state.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>lexer_state = {<table><tr class="fld"><td><div class="region" id="/lexer_state.typ/buf.fld"><a href="#/lexer_state.typ/buf.fld" class="anchor"></a>buf</div></td><td> : </td><td>Bi_outbuf.t;</td><td>(*</td><td><div class="doc">Buffer used to accumulate substrings</div></td><td>*)</td></tr><tr class="fld"><td><div class="region" id="/lexer_state.typ/lnum.fld"><a href="#/lexer_state.typ/lnum.fld" class="anchor"></a><span class="keyword">mutable </span>lnum</div></td><td> : </td><td>int;</td><td>(*</td><td><div class="doc">Current line number (counting from 1)</div></td><td>*)</td></tr><tr class="fld"><td><div class="region" id="/lexer_state.typ/bol.fld"><a href="#/lexer_state.typ/bol.fld" class="anchor"></a><span class="keyword">mutable </span>bol</div></td><td> : </td><td>int;</td><td>(*</td><td><div class="doc">Absolute position of the first character of the current line
(counting from 0)</div></td><td>*)</td></tr><tr class="fld"><td><div class="region" id="/lexer_state.typ/fname.fld"><a href="#/lexer_state.typ/fname.fld" class="anchor"></a><span class="keyword">mutable </span>fname</div></td><td> : </td><td>string option;</td><td>(*</td><td><div class="doc">Name referencing the input file in error messages</div></td><td>*)</td></tr></table>}</div><div class="doc"></div></div></div><div class="region" id="/Lexer_state"><a href="#/Lexer_state" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Lexer_state/index.html">Lexer_state</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc"></div></div></div><div class="region" id="/init_lexer.val"><a href="#/init_lexer.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>init_lexer : ?buf:Bi_outbuf.t -&gt; ?fname:string -&gt; ?lnum:int -&gt; unit -&gt; <a href="index.html#/lexer_state.typ">lexer_state</a></div><div class="doc">Create a fresh lexer_state record.</div></div></div><div class="exn"><div class="def"><span class="keyword">exn </span>End_of_array</div><div class="doc"></div></div><div class="exn"><div class="def"><span class="keyword">exn </span>End_of_object</div><div class="doc"></div></div><div class="exn"><div class="def"><span class="keyword">exn </span>End_of_tuple</div><div class="doc"></div></div><div class="exn"><div class="def"><span class="keyword">exn </span>End_of_input</div><div class="doc"></div></div><div class="doc"><h1>Basic JSON tree type</h1></div><div class="region" id="/Basic"><a href="#/Basic" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Basic/index.html">Basic</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc"></div></div></div><div class="doc"><h1>Multipurpose JSON tree type</h1></div><div class="region" id="/Safe"><a href="#/Safe" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Safe/index.html">Safe</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc"></div></div></div><div class="doc"><h1>JSON tree type with literal int/float/string leaves</h1></div><div class="region" id="/Raw"><a href="#/Raw" class="anchor"></a><div class="mod"><div class="def"><span class="keyword">module </span><a href="Raw/index.html">Raw</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></div><div class="doc"></div></div></div><div class="doc"><h1>Supertype of all JSON tree types</h1></div><div class="doc"><h3>Type of the JSON tree</h3></div><div class="region" id="/json.typ"><a href="#/json.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>json = [ `Null | `Bool of bool | `Int of int | `Intlit of string | `Float of float | `Floatlit of string | `String of string | `Stringlit of string | `Assoc of (string * <a href="index.html#/json.typ">json</a>) list | `List of <a href="index.html#/json.typ">json</a> list | `Tuple of <a href="index.html#/json.typ">json</a> list | `Variant of string * <a href="index.html#/json.typ">json</a> option ]</div><div class="doc">All possible cases defined in Yojson:
<ul><li>`Null: JSON null</li><li>`Bool of bool: JSON boolean</li><li>`Int of int: JSON number without decimal point or exponent.</li><li>`Intlit of string: JSON number without decimal point or exponent,
preserved as a string.</li><li>`Float of float: JSON number, Infinity, -Infinity or NaN.</li><li>`Floatlit of string: JSON number, Infinity, -Infinity or NaN,
preserved as a string.</li><li>`String of string: JSON string. Bytes in the range 128-255 are preserved
as-is without encoding validation for both reading
and writing.</li><li>`Stringlit of string: JSON string literal including the double quotes.</li><li>`Assoc of (string * json) list: JSON object.</li><li>`List of json list: JSON array.</li><li>`Tuple of json list: Tuple (non-standard extension of JSON).
Syntax: <code>(&quot;abc&quot;, 123)</code>.</li><li>`Variant of (string * json option): Variant (non-standard extension of JSON).
Syntax: <code>&lt;&quot;Foo&quot;&gt;</code> or <code>&lt;&quot;Bar&quot;:123&gt;</code>.</li></ul></div></div></div><div class="region" id="/json_max.typ"><a href="#/json_max.typ" class="anchor"></a><div class="typ"><div class="def"><span class="keyword">type </span>json_max = <a href="index.html#/json.typ">json</a></div><div class="doc">All possible cases defined in Yojson:
<ul><li>`Null: JSON null</li><li>`Bool of bool: JSON boolean</li><li>`Int of int: JSON number without decimal point or exponent.</li><li>`Intlit of string: JSON number without decimal point or exponent,
preserved as a string.</li><li>`Float of float: JSON number, Infinity, -Infinity or NaN.</li><li>`Floatlit of string: JSON number, Infinity, -Infinity or NaN,
preserved as a string.</li><li>`String of string: JSON string. Bytes in the range 128-255 are preserved
as-is without encoding validation for both reading
and writing.</li><li>`Stringlit of string: JSON string literal including the double quotes.</li><li>`Assoc of (string * json) list: JSON object.</li><li>`List of json list: JSON array.</li><li>`Tuple of json list: Tuple (non-standard extension of JSON).
Syntax: <code>(&quot;abc&quot;, 123)</code>.</li><li>`Variant of (string * json option): Variant (non-standard extension of JSON).
Syntax: <code>&lt;&quot;Foo&quot;&gt;</code> or <code>&lt;&quot;Bar&quot;:123&gt;</code>.</li></ul><br/><h2>JSON writers</h2></div></div></div><div class="region" id="/to_string.val"><a href="#/to_string.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>to_string : ?buf:Bi_outbuf.t -&gt; ?len:int -&gt; ?std:bool -&gt; <a href="index.html#/json.typ">json</a> -&gt; string</div><div class="doc">Write a compact JSON value to a string.</div></div></div><div class="region" id="/to_channel.val"><a href="#/to_channel.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>to_channel : ?buf:Bi_outbuf.t -&gt; ?len:int -&gt; ?std:bool -&gt; <a href="../../ocaml/Pervasives/index.html#/out_channel.typ">Pervasives.out_channel</a> -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc">Write a compact JSON value to a channel.</div></div></div><div class="region" id="/to_output.val"><a href="#/to_output.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>to_output : ?buf:Bi_outbuf.t -&gt; ?len:int -&gt; ?std:bool -&gt; &lt; output : string -&gt; int -&gt; int -&gt; int; .. &gt; -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc">Write a compact JSON value to an OO channel.</div></div></div><div class="region" id="/to_file.val"><a href="#/to_file.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>to_file : ?len:int -&gt; ?std:bool -&gt; string -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc">Write a compact JSON value to a file.
See <code>to_string</code> for the role of the optional arguments.</div></div></div><div class="region" id="/to_outbuf.val"><a href="#/to_outbuf.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>to_outbuf : ?std:bool -&gt; Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc">Write a compact JSON value to an existing buffer.
See <code>to_string</code> for the role of the optional argument.</div></div></div><div class="region" id="/stream_to_string.val"><a href="#/stream_to_string.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>stream_to_string : ?buf:Bi_outbuf.t -&gt; ?len:int -&gt; ?std:bool -&gt; <a href="index.html#/json.typ">json</a> <a href="../../ocaml/Stream/index.html#/t.typ">Stream.t</a> -&gt; string</div><div class="doc">Write a newline-separated sequence of compact one-line JSON values to
a string.
See <code>to_string</code> for the role of the optional arguments.</div></div></div><div class="region" id="/stream_to_channel.val"><a href="#/stream_to_channel.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>stream_to_channel : ?buf:Bi_outbuf.t -&gt; ?len:int -&gt; ?std:bool -&gt; <a href="../../ocaml/Pervasives/index.html#/out_channel.typ">Pervasives.out_channel</a> -&gt; <a href="index.html#/json.typ">json</a> <a href="../../ocaml/Stream/index.html#/t.typ">Stream.t</a> -&gt; unit</div><div class="doc">Write a newline-separated sequence of compact one-line JSON values to
a channel.
See <code>to_channel</code> for the role of the optional arguments.</div></div></div><div class="region" id="/stream_to_file.val"><a href="#/stream_to_file.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>stream_to_file : ?len:int -&gt; ?std:bool -&gt; string -&gt; <a href="index.html#/json.typ">json</a> <a href="../../ocaml/Stream/index.html#/t.typ">Stream.t</a> -&gt; unit</div><div class="doc">Write a newline-separated sequence of compact one-line JSON values to
a file.
See <code>to_string</code> for the role of the optional arguments.</div></div></div><div class="region" id="/stream_to_outbuf.val"><a href="#/stream_to_outbuf.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>stream_to_outbuf : ?std:bool -&gt; Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> <a href="../../ocaml/Stream/index.html#/t.typ">Stream.t</a> -&gt; unit</div><div class="doc">Write a newline-separated sequence of compact one-line JSON values to
an existing buffer.
See <code>to_string</code> for the role of the optional arguments.</div></div></div><div class="doc"><h2>Miscellaneous</h2></div><div class="region" id="/sort.val"><a href="#/sort.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>sort : <a href="index.html#/json.typ">json</a> -&gt; <a href="index.html#/json.typ">json</a></div><div class="doc">Sort object fields (stable sort, comparing field names
and treating them as byte sequences)</div></div></div><div class="region" id="/write_null.val"><a href="#/write_null.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_null : Bi_outbuf.t -&gt; unit -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_bool.val"><a href="#/write_bool.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_bool : Bi_outbuf.t -&gt; bool -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_int.val"><a href="#/write_int.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_int : Bi_outbuf.t -&gt; int -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_float.val"><a href="#/write_float.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_float : Bi_outbuf.t -&gt; float -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_std_float.val"><a href="#/write_std_float.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_std_float : Bi_outbuf.t -&gt; float -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_float_fast.val"><a href="#/write_float_fast.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_float_fast : Bi_outbuf.t -&gt; float -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_std_float_fast.val"><a href="#/write_std_float_fast.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_std_float_fast : Bi_outbuf.t -&gt; float -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_float_prec.val"><a href="#/write_float_prec.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_float_prec : int -&gt; Bi_outbuf.t -&gt; float -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_std_float_prec.val"><a href="#/write_std_float_prec.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_std_float_prec : int -&gt; Bi_outbuf.t -&gt; float -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_string.val"><a href="#/write_string.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_string : Bi_outbuf.t -&gt; string -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_intlit.val"><a href="#/write_intlit.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_intlit : Bi_outbuf.t -&gt; string -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_floatlit.val"><a href="#/write_floatlit.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_floatlit : Bi_outbuf.t -&gt; string -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_stringlit.val"><a href="#/write_stringlit.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_stringlit : Bi_outbuf.t -&gt; string -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_assoc.val"><a href="#/write_assoc.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_assoc : Bi_outbuf.t -&gt; (string * <a href="index.html#/json.typ">json</a>) list -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_list.val"><a href="#/write_list.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_list : Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> list -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_tuple.val"><a href="#/write_tuple.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_tuple : Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> list -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_std_tuple.val"><a href="#/write_std_tuple.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_std_tuple : Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> list -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_variant.val"><a href="#/write_variant.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_variant : Bi_outbuf.t -&gt; string -&gt; <a href="index.html#/json.typ">json</a> option -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_std_variant.val"><a href="#/write_std_variant.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_std_variant : Bi_outbuf.t -&gt; string -&gt; <a href="index.html#/json.typ">json</a> option -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_json.val"><a href="#/write_json.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_json : Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc"></div></div></div><div class="region" id="/write_std_json.val"><a href="#/write_std_json.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>write_std_json : Bi_outbuf.t -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc"></div></div></div><div class="doc"><h2>JSON pretty-printing</h2></div><div class="region" id="/pretty_format.val"><a href="#/pretty_format.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>pretty_format : ?std:bool -&gt; <a href="index.html#/json.typ">json</a> -&gt; Easy_format.t</div><div class="doc">Convert into a pretty-printable tree.
See <code>to_string</code> for the role of the optional <code>std</code> argument.</div></div></div><div class="region" id="/pretty_print.val"><a href="#/pretty_print.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>pretty_print : ?std:bool -&gt; <a href="../../ocaml/Format/index.html#/formatter.typ">Format.formatter</a> -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc">Pretty-print into a <a href="../../ocaml/Format/index.html#/formatter.typ">Format.formatter</a>.
See <code>to_string</code> for the role of the optional <code>std</code> argument.</div></div></div><div class="region" id="/pretty_to_string.val"><a href="#/pretty_to_string.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>pretty_to_string : ?std:bool -&gt; <a href="index.html#/json.typ">json</a> -&gt; string</div><div class="doc">Pretty-print into a string.
See <code>to_string</code> for the role of the optional <code>std</code> argument.</div></div></div><div class="region" id="/pretty_to_channel.val"><a href="#/pretty_to_channel.val" class="anchor"></a><div class="val"><div class="def"><span class="keyword">val </span>pretty_to_channel : ?std:bool -&gt; <a href="../../ocaml/Pervasives/index.html#/out_channel.typ">Pervasives.out_channel</a> -&gt; <a href="index.html#/json.typ">json</a> -&gt; unit</div><div class="doc">Pretty-print to a channel.
See <code>to_string</code> for the role of the optional <code>std</code> argument.</div></div></div></div></div></div></body></html>